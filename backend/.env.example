# Server Configuration
PORT=8080
HOST=0.0.0.0

# CORS Configuration
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# Git Configuration
GIT_TERMINAL=dumb
GIT_ASKPASS=echo
GIT_SSH_COMMAND=ssh -o StrictHostKeyChecking=no

# Temporary Directory
TEMP_DIR=/tmp/chartimpact

# Timeouts (in seconds)
COMPARE_TIMEOUT=120
VERSIONS_TIMEOUT=60
GIT_CLONE_TIMEOUT=120
HELM_TIMEOUT=60

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# Diff Engine Configuration
# INTERNAL_DIFF_ENABLED: Set to true to use the internal diff engine (recommended, default)
# The internal diff engine provides better performance, semantic understanding, and structured output
# without requiring external dependencies.
INTERNAL_DIFF_ENABLED=true

# DEPRECATED: The following settings are deprecated and will be removed in a future version
# DYFF_ENABLED: Controls dyff usage (only applies when INTERNAL_DIFF_ENABLED=false)
# Falls back to simple diff if dyff is not available
# WARNING: Disabling the internal diff engine is not recommended
# Default is now false since dyff is deprecated
# DYFF_ENABLED=false

# ============================================================================
# Storage & Analytics Configuration (Optional - Feature Flag)
# ============================================================================
# Enable persistent storage of comparison results for replay and analytics
# Set to 'true' to enable storage, 'false' to disable (default: false)
# When disabled, ChartImpact works normally but without result persistence
STORAGE_ENABLED=false

# Database Connection
# PostgreSQL connection string for storing comparison results
# Format: postgres://username:password@host:port/database?sslmode=disable
# Example: postgres://chartimpact:chartimpact@localhost:5432/chartimpact?sslmode=disable
# DATABASE_URL=postgres://chartimpact:chartimpact@localhost:5432/chartimpact?sslmode=disable

# Database Connection Pool
# Maximum number of open connections to the database (default: 25)
# Adjust based on your database capacity and expected concurrent load
DB_MAX_CONNECTIONS=25

# Result Retention
# Number of days to retain stored comparison results before automatic cleanup (default: 30)
# Results older than this will be deleted by the cleanup function
# Set to 0 to disable automatic expiration (not recommended)
RESULT_TTL_DAYS=30

# ============================================================================
# Notes on Storage Feature:
# ============================================================================
# When STORAGE_ENABLED=true, you need:
# 1. PostgreSQL 15+ running and accessible
# 2. DATABASE_URL configured with valid credentials
# 3. Database migrations applied (auto-applied with docker-compose)
# 4. Sufficient disk space for compressed results (~75% compression ratio)
#
# Benefits of enabling storage:
# - Result replay via permalink URLs (/analysis/{uuid})
# - Deduplication of identical comparisons (instant cache hits)
# - Analytics dashboard with popular charts and trends
# - Gzip compression (~75% size reduction)
# - 30-day result retention with automatic cleanup
#
# See STORAGE_SPEC.md for complete documentation
